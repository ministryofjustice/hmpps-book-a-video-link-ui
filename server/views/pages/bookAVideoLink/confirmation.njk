{% extends "partials/layout.njk" %}

{% from "govuk/components/panel/macro.njk" import govukPanel %}
{% from "govuk/components/summary-list/macro.njk" import govukSummaryList %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% set pageTitle = "The video link has been booked" %}

{% block content %}
    <div class="govuk-grid-row">
        <div class="govuk-grid-column-two-thirds">
            {{ govukPanel({ titleText: pageTitle, classes: 'govuk-!-margin-bottom-9' }) }}

            <h2 class='govuk-heading-m'>Video link details</h2>
            {{ govukSummaryList({
                rows: [
                    {
                        key: {
                            text: "Name"
                        },
                        value: {
                            text: ((prisoner.firstName + " " + prisoner.lastName) | convertToTitleCase) + ' (' + prisoner.prisonerNumber + ')'
                        }
                    },
                    {
                        key: {
                            text: "Prison"
                        },
                        value: {
                            text: prisoner.prisonName
                        }
                    },
                    {
                        key: {
                            text: "Court"
                        },
                        value: {
                            text: booking.courtDescription
                        }
                    } if booking.bookingType == 'COURT',
                    {
                        key: {
                            text: "Probation team"
                        },
                        value: {
                            text: booking.probationTeamDescription
                        }
                    } if booking.bookingType == 'PROBATION',
                    {
                        key: {
                            text: "Hearing type"
                        },
                        value: {
                            text: booking.courtHearingTypeDescription
                        }
                    } if booking.bookingType == 'COURT',
                    {
                        key: {
                            text: "Meeting type"
                        },
                        value: {
                            text: booking.probationMeetingTypeDescription
                        }
                    } if booking.bookingType == 'PROBATION',
                    {
                        key: {
                            text: "Date"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_MAIN')).appointmentDate | formatDate
                        }
                    } if booking.bookingType == 'COURT',
                    {
                        key: {
                            text: "Date"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_PROBATION')).appointmentDate | formatDate
                        }
                    } if booking.bookingType == 'PROBATION',
                    {
                        key: {
                            text: "Prison room for court hearing"
                        },
                        value: {
                            text: (rooms | find('key', (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_MAIN')).prisonLocKey)).description
                        }
                    } if booking.bookingType == 'COURT',
                    {
                        key: {
                            text: "Prison room for probation meeting"
                        },
                        value: {
                            text: (rooms | find('key', (booking.prisonAppointments | find('appointmentType', 'VLB_PROBATION')).prisonLocKey)).description
                        }
                    } if booking.bookingType == 'PROBATION',
                    {
                        key: {
                            text: "Hearing start time"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_MAIN')).startTime
                        }
                    } if booking.bookingType == 'COURT',
                    {
                        key: {
                            text: "Meeting start time"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_PROBATION')).startTime
                        }
                    } if booking.bookingType == 'PROBATION',
                    {
                        key: {
                            text: "Hearing end time"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_MAIN')).endTime
                        }
                    } if booking.bookingType == 'COURT',
                    {
                        key: {
                            text: "Meeting end time"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_PROBATION')).endTime
                        }
                    } if booking.bookingType == 'PROBATION',
                    {
                        key: {
                            text: "Prison room for pre-court hearing"
                        },
                        value: {
                            text: (rooms | find('key', (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_PRE')).prisonLocKey)).description
                        }
                    } if booking.prisonAppointments | find('appointmentType', 'VLB_COURT_PRE'),
                    {
                        key: {
                            text: "Pre-hearing start time"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_PRE')).startTime
                        }
                    } if booking.prisonAppointments | find('appointmentType', 'VLB_COURT_PRE'),
                    {
                        key: {
                            text: "Pre-hearing end time"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_PRE')).endTime
                        }
                    } if booking.prisonAppointments | find('appointmentType', 'VLB_COURT_PRE'),
                    {
                        key: {
                            text: "Prison room for post-court hearing"
                        },
                        value: {
                            text: (rooms | find('key', (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_POST')).prisonLocKey)).description
                        }
                    } if booking.prisonAppointments | find('appointmentType', 'VLB_COURT_POST'),
                    {
                        key: {
                            text: "Post-hearing start time"
                        },
                        value: {
                            text: (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_POST')).startTime
                        }
                    } if booking.prisonAppointments | find('appointmentType', 'VLB_COURT_POST'),
                    {
                        key: {
                            text: "Post-hearing end time"
                        },
                        value: {
                            text:  (booking.prisonAppointments | find('appointmentType', 'VLB_COURT_POST')).endTime
                        }
                    } if booking.prisonAppointments | find('appointmentType', 'VLB_COURT_POST'),
                    {
                        key: {
                            text: "Video Link URL"
                        },
                        value: {
                            text: booking.videoLinkUrl
                        }
                    } if booking.videoLinkUrl
                ]
            }) }}

            <a href='/booking/{{ session.req.params.type}}/create/prisoner-search' class="govuk-link govuk-link--no-visited-state govuk-!-font-size-19" data-qa='bookAnotherLink'>Book another video link</a>

            <div class='govuk-!-margin-top-3'>
                {{ govukButton({
                    text: "Exit",
                    href: '/'
                }) }}
            </div>
        </div>
    </div>
{% endblock %}
